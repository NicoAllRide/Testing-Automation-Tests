*** Settings ***
Library     RequestsLibrary
Library     OperatingSystem
Library     Collections
Library     String
Library     DateTime
Library     Collections
Library     SeleniumLibrary
Library     RPA.JSON
Resource    ../Variables/variablesStage.robot

*** Variables ***

${current_time}=    Evaluate    time.time() + 360    time
${formatted_time}=    Evaluate    time.strftime('%a, %d %b %Y %H:%M:%S GMT', time.gmtime(${current_time}))    time



*** Test Cases ***
Set Date Variables
    ${fecha_hoy}=    Get Current Date    result_format=%Y-%m-%d
    Set Global Variable    ${fecha_hoy}

    ${fecha_manana}=    Add Time To Date    ${fecha_hoy}    1 days    result_format=%Y-%m-%d
    Set Global Variable    ${fecha_manana}

    ${fecha_pasado_manana}=    Add Time To Date    ${fecha_hoy}    2 days    result_format=%Y-%m-%d
    Set Global Variable    ${fecha_pasado_manana}
    ${fecha_pasado_pasado_manana}=    Add Time To Date    ${fecha_hoy}    3 days    result_format=%Y-%m-%d
    Set Global Variable    ${fecha_pasado_pasado_manana}

    ${dia_actual}=    Convert Date    ${fecha_hoy}    result_format=%a
    ${dia_actual_lower}=    Set Variable    ${dia_actual.lower()}
    ${dia_manana}=    Convert Date    ${fecha_manana}    result_format=%a
    ${dia_manana_lower}=    Set Variable    ${dia_manana.lower()}

    ${arrival_date}=    Set Variable    ${fecha_manana}T01:00:00.000Z
    Set Global Variable    ${arrival_date}
    ${r_estimated_arrival1}=    Set Variable    ${fecha_manana}T14:45:57.000Z
    Set Global Variable    ${r_estimated_arrival1}
    ${service_date}=    Set Variable    ${fecha_manana}T00:25:29.000Z
    Set Global Variable    ${service_date}
    ${modified_arrival_date}=    Set Variable    ${fecha_manana}T01:00:00.000Z
    Set Global Variable    ${modified_arrival_date}
    ${r_modified_estimated_arrival}=    Set Variable    ${fecha_pasado_manana}T14:45:57.000Z
    Set Global Variable    ${r_modified_estimated_arrival}
    ${modified_service_date}=    Set Variable    ${fecha_manana}T00:25:29.000Z
    Set Global Variable    ${modified_service_date}
    ${service_date_20min}=    Set Variable    ${fecha_manana}T00:20:00.000Z
    Set Global Variable    ${service_date_20min}
    ${service_date_22min}=    Set Variable    ${fecha_manana}T00:47:00.000Z
    Set Global Variable    ${service_date_22min}
    ${start_date}=    Set Variable    ${fecha_manana}T03:00:00.000Z
    Set Global Variable    ${start_date}
    ${end_date_4weeks}=    Set Variable    2023-12-30T02:59:59.999Z
    Set Global Variable    ${end_date_4weeks}
    ${end_date}=    Set Variable    ${fecha_pasado_pasado_manana}T03:00:00.000Z
    Set Global Variable    ${end_date}
    ${end_date_tomorrow}=    Set Variable    ${fecha_manana}T03:00:00.000Z
    Set Global Variable    ${end_date_tomorrow}
    ${schedule_day}=    Set Variable    ${dia_actual_lower}
    Set Global Variable    ${schedule_day}
    ${schedule_day_tomorrow}=    Set Variable    ${dia_manana_lower}
    Set Global Variable    ${schedule_day_tomorrow}
    ${start_date_today}=    Set Variable    ${fecha_hoy}T03:00:00.000Z
    Set Global Variable    ${start_date_today}
    ${today_date}=    Set Variable    ${fecha_hoy}
    Set Global Variable    ${today_date}
    ${end_date_tomorrow2}=    Set Variable    ${fecha_manana}T02:59:59.999Z
    Set Global Variable    ${end_date_tomorrow}
    ${expiration_date_qr}=    Set Variable    ${fecha_manana}T14:10:37.968Z
    Set Global Variable    ${expiration_date_qr}
    ${start_date_tickets}=     Set Variable     ${fecha_hoy}T04:00:00.000Z
        Set Global Variable    ${start_date_tickets}
    ${end_date_tickets}=     Set Variable     ${fecha_manana}T03:59:59.999Z
        Set Global Variable    ${end_date_tickets}

    ${start_date_tomorrow2}=    Set Variable    ${fecha_manana}T04:00:00.000Z
    Set Global Variable     ${start_date_tomorrow2}

    ${end_date_pastTomorrow}=    Set Variable    ${fecha_pasado_manana}T03:59:59.999Z
    Set Global Variable    ${end_date_pastTomorrow}


1 hours local
    ${date}    Get Current Date    time_zone=local    exclude_millis=yes
    ${formatted_date}    Convert Date    ${date}    result_format=%H:%M:%S
    Log    Hora Actual: ${formatted_date}

    # Sumar una hora
    ${one_hour_later}    Add Time To Date    ${date}    1 hour
    ${formatted_one_hour_later}    Convert Date    ${one_hour_later}    result_format=%H:%M
    Log    Hora Actual + 1 hora: ${formatted_one_hour_later}
    Set Global Variable    ${formatted_one_hour_later}
2 hours local
    ${date}    Get Current Date    time_zone=local    exclude_millis=yes
    ${formatted_date}    Convert Date    ${date}    result_format=%H:%M:%S
    Log    Hora Actual: ${formatted_date}

    # Sumar una hora
    ${one_hour_later}    Add Time To Date    ${date}    2 hour
    ${formatted_two_hour_later}    Convert Date    ${one_hour_later}    result_format=%H:%M
    Log    Hora Actual + 1 hora: ${formatted_two_hour_later}
    Set Global Variable    ${formatted_two_hour_later}


## Crear ruta con tres servicios asociados, una hora y dos horas más tarde, y un día siguiente
## Obtener el id de servicio de ambos
## Reservar en uno, reservar en otro
## Modificar la restricción para una reserva en un 5 minutos, no debería funcionar
## Modificar el test de reservar para que sea luego de 5 minutos debería funcionar
##Lo mismo con horas y días
## Para dias sería obtener el id de algún servicio calendarizado del dia siguiente el cual sería el último creado de igual manera

Create Schedule 3 services
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json; charset=utf-8
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    POST On Session
    ...    mysesion
    ...    url=/api/v1/admin/pb/routes?community=${idComunidad2}
    ...    data={"name":"Ruta 3 servicios TEMPLATE","description":"Ruta 3 servicios TEMPLATE","communities":["6654ae4eba54fe502d4e4187"],"superCommunities":[],"ownerIds":[{"id":"6654ae4eba54fe502d4e4187","role":"community"}],"assistantIds":[],"shapeId":"6654d514713b9a5184cfe21e","usesBusCode":false,"usesVehicleList":true,"usesDriverCode":false,"allowsOnlyExistingDrivers":false,"allowsMultipleDrivers":false,"dynamicSeatAssignment":true,"usesTickets":false,"startsOnStop":false,"notNearStop":false,"routeCost":0,"ticketCost":0,"excludePassengers":{"active":false,"excludeType":"dontHide"},"restrictPassengers":{"enabled":false,"allowed":[],"visibility":{"enabled":false,"excludes":false,"parameters":[]}},"endDepartureNotice":{"enabled":false,"lastStop":null},"scheduling":{"enabled":true,"limitUnit":"minutes","limitAmount":30,"lateNotification":{"enabled":false,"amount":0,"unit":"minutes"},"stopNotification":{"enabled":false,"amount":0,"unit":"minutes"},"startLimit":{"upperLimit":{"amount":60,"unit":"minutes"},"lowerLimit":{"amount":30,"unit":"minutes"}},"defaultServiceCost":null,"schedule":[{"enabled":true,"day":"${schedule_day}","time":"${formatted_one_hour_later}","estimatedArrival":null,"stopSchedule":[],"capped":{"enabled":false,"capacity":0},"vehicleCategoryId":null,"defaultResources":[],"serviceCost":0,"observations":"","_ogIndex":0},{"enabled":true,"day":"${schedule_day}","time":"${formatted_two_hour_later}","estimatedArrival":null,"stopSchedule":[],"capped":{"enabled":false,"capacity":0},"vehicleCategoryId":null,"defaultResources":[],"serviceCost":0,"observations":"","_ogIndex":1},{"enabled":true,"day":"${schedule_day_tomorrow}","time":"08:00","estimatedArrival":null,"stopSchedule":[],"capped":{"enabled":false,"capacity":0},"vehicleCategoryId":null,"defaultResources":[],"serviceCost":0,"observations":"","_ogIndex":2}],"stopOnReservation":true,"restrictions":{"customParams":{"enabled":false,"params":[]}}},"customParams":{"enabled":false,"params":[]},"customParamsAtTheEnd":{"enabled":false,"params":[]},"validationParams":{"enabled":false,"driverParams":[],"passengerParams":[]},"allowsServiceSnapshots":false,"allowsNonServiceSnapshots":false,"labels":[],"roundOrder":[],"anchorStops":[],"originStop":"6654d4acba54fe502d4e6b6b","destinationStop":"6654d4c8713b9a5184cfe1df","allowsRating":false,"hasBeacons":false,"hasCapacity":false,"isStatic":false,"showParable":false,"extraInfo":"","color":"9a4040","usesManualSeat":true,"allowsManualValidation":true,"usesDriverPin":false,"hasBoardings":true,"hasUnboardings":true,"allowsDistance":true,"allowGenericVehicles":true,"hasExternalGPS":false,"departureHourFulfillment":{"enabled":false,"ranges":[]},"usesOfflineCount":false,"visible":true,"active":true,"usesTextToSpeech":false,"hasBoardingCount":false,"hasRounds":false,"hasUnboardingCount":false,"timeOnRoute":15,"distance":9,"distanceInMeters":8794,"legOptions":[],"validateDeparture":{"enabled":true},"rounds":{"enabled":false,"anchorStops":[]},"trail":{"enabled":false,"adjustByRounds":false},"route_type":3}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

    ${scheduleId}=    Set Variable    ${response.json()}[_id]
    Set Global Variable    ${scheduleId}
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)
Get Service Id (Today, last service and pre-last)
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)
    ${url}=    Set Variable
    ...    ${STAGE_URL}/api/v1/admin/pb/allServices?community=${idComunidad2}&startDate=${start_date_today}&endDate=${end_date_tomorrow}&onlyODDs=false
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}
    ${response}=    GET    url=${url}    headers=${headers}
    ${responseJson}=    Set Variable    ${response.json()}
    ${service_id}=    Set Variable    None

    # Obtenemos la cantidad de objetos de scheduledServices
    ${num_scheduled_services}=    Get Length    ${responseJson}
    
    # Ordenamos los servicios por createdAt

    ${sorted_services}=    Evaluate    sorted(${responseJson}, key=lambda x: x['createdAt'])    json
    
    # Obtenemos el último servicio creado
    ${last_service}=    Set Variable    ${sorted_services[-1]}
    ${last_service2}=    Set Variable    ${sorted_services[-2]}
    ${service_id}=    Set Variable    ${last_service['_id']}
    ${service_id2}=    Set Variable    ${last_service2['_id']}
    ${last_service_route}=    Set Variable    ${last_service['routeId']['_id']}
    ${last_service_route2}=    Set Variable    ${last_service2['routeId']['_id']}
    Should Be Equal As Strings    ${scheduleId}    ${last_service_route}
    Should Be Equal As Strings    ${scheduleId}    ${last_service_route2}
    
    Set Global Variable    ${service_id}
    Set Global Variable    ${service_id2}

    Log    Last created service ID: ${service_id}
Get Service Id (Tomorrow)
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)
    ${url}=    Set Variable      ##Modificar el start day end day para que sea mañana
    ...    ${STAGE_URL}/api/v1/admin/pb/allServices?community=${idComunidad2}&startDate=${start_date_tomorrow2}&endDate=${end_date_pastTomorrow}&onlyODDs=false
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}
    ${response}=    GET    url=${url}    headers=${headers}
    ${responseJson}=    Set Variable    ${response.json()}
    ${service_id}=    Set Variable    None

    # Obtenemos la cantidad de objetos de scheduledServices
    ${num_scheduled_services}=    Get Length    ${responseJson}
    
    # Ordenamos los servicios por createdAt

    ${sorted_services}=    Evaluate    sorted(${responseJson}, key=lambda x: x['createdAt'])    json
    
    # Obtenemos el último servicio creado
    ${last_service}=    Set Variable    ${sorted_services[-1]}
    ${service_id3}=    Set Variable    ${last_service['_id']}
    ${last_service_route}=    Set Variable    ${last_service['routeId']['_id']}
    Should Be Equal As Strings    ${scheduleId}    ${last_service_route}
    
    Set Global Variable    ${service_id3}

    Log    Last created service ID: ${service_id3}

Resource Assignment First Service(Driver and Vehicle)
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    POST On Session
    ...    mysesion
    ...    url= /api/v1/admin/pb/assignServiceResources/${service_id}?community=${idComunidad2}
    ...    data=[{"multipleDrivers":false,"driver":{"driverId":"6654cec2ba54fe502d4e6a0a"},"drivers":[],"vehicle":{"vehicleId":"666941a7b8d6ea30f9281110","capacity":"5"},"passengers":[],"departure":null}]
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}
Resource Assignment Second Service(Driver and Vehicle)
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    POST On Session
    ...    mysesion
    ...    url= /api/v1/admin/pb/assignServiceResources/${service_id2}?community=${idComunidad2}
    ...    data=[{"multipleDrivers":false,"driver":{"driverId":"6654cec2ba54fe502d4e6a0a"},"drivers":[],"vehicle":{"vehicleId":"666941a7b8d6ea30f9281110","capacity":"5"},"passengers":[],"departure":null}]
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

Restriction 1 reservation 5 minutes
    
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    PUT On Session
    ...    mysesion
    ...    url=https://stage.allrideapp.com/api/v1/admin/community/6654ae4eba54fe502d4e4187
    ...    data={"_id":"6654ae4eba54fe502d4e4187","config":{"general":{"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"public":true,"assocCommunities":[],"hidePersonalInfoForSC":false,"ui":{},"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"products":{"enabled":false}},"privateBus":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":false,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":false},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[]},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":false}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"emergencyCall":{"enabled":true},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"restrictRTL":{"enabled":false},"emergencyCallSettings":{"enabled":true},"enabled":true,"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"driverParams":[],"auxiliaryTrackers":[],"ui":{},"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]},"driverCanCreateRoutes":true,"hideSCDriverNames":false,"startUnassignedDeparture":false,"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}}},"parking":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolBus":{"enabled":false},"publicBus":{"enabled":true}},"custom":{"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"realTimeTransportSystem":{"buses":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":false},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[],"maxValidationTime":{"amount":1,"unit":"hours"}},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"wfIntegration":{"enabled":false},"tracker":{"enabled":false},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"emergencyCall":{"enabled":true},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"custom":{"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"}},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"emergencyCallSettings":{"enabled":true},"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}},"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"harassmentAssistance":true,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"auxiliaryTrackers":[],"startUnassignedDeparture":false,"driverParams":[],"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]}},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolbus":{"enabled":false}},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"parkingLots":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"driverCanCreateRoutes":true,"products":{"enabled":false}},"emailSuffixes":[],"admins":[],"timezone":"Chile/Continental","type":"normal","distance":0,"allowAds":false,"assocCommunities":[],"public":true,"name":"Comunidad Automatización 2","site":"http://adminstage.allrideapp.com","terms":null,"country":"cl","isStudentsCommunity":false,"hasBusesSystem":true,"language":"es","avatar":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083265.png","badge":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083787.png","createdAt":"2024-05-27T16:01:18.808Z","updatedAt":"2024-07-18T15:56:42.881Z","__v":26}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}



####-----------------------RESTRICCIÖN 5 MINUTOS-----------------------------#########
    ####-----------------------Reservacion de un unico usuario para primer servicio CORRECTO-----------------------------#########
    ####-----------------------Reservacion de un unico usuario para segundo servicio FALLO-----------------------------#########
    ####-----------------------Reservacion de un unico usuario para segundo servicio modificado el tiempo para 5 minutos CORRECTO-----------------------------#########

Get departureId First Reservation
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)
    ${url}=    Set Variable
    ...    ${STAGE_URL}/api/v1/admin/pb/service/${service_id}?community=${idComunidad2}

    # Configura las opciones de la solicitud (headers, auth)
    &{headers}=    Create Dictionary    Authorization=${tokenAdmin}

    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    GET    url=${url}    headers=${headers}

    Should Be Equal As Numbers    ${response.status_code}    200

    # Almacenamos la respuesta de json en una variable para poder jugar con ella
    ${responseJson}=    Set Variable    ${response.json()}

    ${departureId}=    Set Variable    ${response.json()}[resources][0][departure][departureId]
    Set Global Variable    ${departureId}

    Log    ${departureId}
Get departureId Second Reservation
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)
    ${url}=    Set Variable
    ...    ${STAGE_URL}/api/v1/admin/pb/service/${service_id2}?community=${idComunidad2}

    # Configura las opciones de la solicitud (headers, auth)
    &{headers}=    Create Dictionary    Authorization=${tokenAdmin}

    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    GET    url=${url}    headers=${headers}

    Should Be Equal As Numbers    ${response.status_code}    200

    # Almacenamos la respuesta de json en una variable para poder jugar con ella
    ${responseJson}=    Set Variable    ${response.json()}

    ${departureId2}=    Set Variable    ${response.json()}[resources][0][departure][departureId]
    Set Global Variable    ${departureId2}

    Log    ${departureId2}



Login User With Email(Obtain Token)
        Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)
    # Configura las opciones de la solicitud (headers, auth)
    ${jsonBody}=    Set Variable    {"username":"nicolas+comunidad2@allrideapp.com","password":"Lolowerty21@"}
    ${parsed_json}=    Evaluate    json.loads($jsonBody)    json
    ${headers}=    Create Dictionary    Authorization=""    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    Post On Session
    ...    mysesion
    ...    url=${loginUserUrl}
    ...    json=${parsed_json}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

    ${accessToken}=    Set Variable    ${response.json()}[accessToken]
    ${accessTokenNico}=    Evaluate    "Bearer ${accessToken}"
    Set Global Variable    ${accessTokenNico}

Seat Reservation(User1-Nicolas) Must PASS
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    POST On Session
    ...    mysesion
    ...    ${seatReservation}
    ...    data={"serviceId":"${service_id}","departureId":"${departureId}","stopId":"6654d4acba54fe502d4e6b6b","seat":"1"}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Run Keyword If    '${code}' == '200' or '${code}' == '409'    Log    Status code is acceptable: ${code}
    ...    ELSE    Fail    Unexpected status code: ${code}
    Log    ${code}

    ${reservation1}=    Set Variable    ${response.json()}[0][_id]
    Set Global Variable    ${reservation1}
Seat Reservation(5minutes-Nicolas) Must Fail
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json

    # Realiza la solicitud POST y espera un error HTTP 410
    ${error}=    Run Keyword And Expect Error    HTTPError: 410 Client Error: Gone for url: ${STAGE_URL}${seatReservation}    POST On Session
    ...    mysesion
    ...    ${seatReservation}
    ...    data={"serviceId":"${service_id2}","departureId":"${departureId2}","stopId":"6654d4acba54fe502d4e6b6b","seat":"1"}
    ...    headers=${headers}

    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    Log    ${error}

DELETE reservation1 
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    DELETE On Session
    ...    mysesion
    ...    url=/api/v1/pb/user/booking/${reservation1}
    ...    data={}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Run Keyword If    '${code}' == '200' or '${code}' == '409'    Log    Status code is acceptable: ${code}
    ...    ELSE    Fail    Unexpected status code: ${code}
    Log    ${code}

Back to Normal Admin No Restriction
    
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    PUT On Session
    ...    mysesion
    ...    url=https://stage.allrideapp.com/api/v1/admin/community/6654ae4eba54fe502d4e4187
    ...    data={"_id":"6654ae4eba54fe502d4e4187","config":{"general":{"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"public":true,"assocCommunities":[],"hidePersonalInfoForSC":false,"ui":{},"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"products":{"enabled":false}},"privateBus":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[]},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":false}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"emergencyCall":{"enabled":true},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"restrictRTL":{"enabled":false},"emergencyCallSettings":{"enabled":true},"enabled":true,"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"driverParams":[],"auxiliaryTrackers":[],"ui":{},"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]},"driverCanCreateRoutes":true,"hideSCDriverNames":false,"startUnassignedDeparture":false,"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}}},"parking":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolBus":{"enabled":false},"publicBus":{"enabled":true}},"custom":{"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"realTimeTransportSystem":{"buses":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":false,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[],"maxValidationTime":{"amount":1,"unit":"hours"}},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"wfIntegration":{"enabled":false},"tracker":{"enabled":false},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"emergencyCall":{"enabled":true},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"custom":{"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"}},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"emergencyCallSettings":{"enabled":true},"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}},"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"harassmentAssistance":true,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"auxiliaryTrackers":[],"startUnassignedDeparture":false,"driverParams":[],"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]}},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolbus":{"enabled":false}},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"parkingLots":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"driverCanCreateRoutes":true,"products":{"enabled":false}},"emailSuffixes":[],"admins":[],"timezone":"Chile/Continental","type":"normal","distance":0,"allowAds":false,"assocCommunities":[],"public":true,"name":"Comunidad Automatización 2","site":"http://adminstage.allrideapp.com","terms":null,"country":"cl","isStudentsCommunity":false,"hasBusesSystem":true,"language":"es","avatar":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083265.png","badge":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083787.png","createdAt":"2024-05-27T16:01:18.808Z","updatedAt":"2024-07-18T17:35:00.992Z","__v":41}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

Restriction 1 reservation 1 hour
    
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    PUT On Session
    ...    mysesion
    ...    url=https://stage.allrideapp.com/api/v1/admin/community/6654ae4eba54fe502d4e4187
    ...    data={"_id":"6654ae4eba54fe502d4e4187","config":{"general":{"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"public":true,"assocCommunities":[],"hidePersonalInfoForSC":false,"ui":{},"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"products":{"enabled":false}},"privateBus":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[]},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":false}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"emergencyCall":{"enabled":true},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"restrictRTL":{"enabled":false},"emergencyCallSettings":{"enabled":true},"enabled":true,"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"driverParams":[],"auxiliaryTrackers":[],"ui":{},"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]},"driverCanCreateRoutes":true,"hideSCDriverNames":false,"startUnassignedDeparture":false,"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}}},"parking":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolBus":{"enabled":false},"publicBus":{"enabled":true}},"custom":{"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"realTimeTransportSystem":{"buses":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":1,"unit":"hours","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[],"maxValidationTime":{"amount":1,"unit":"hours"}},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"wfIntegration":{"enabled":false},"tracker":{"enabled":false},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"emergencyCall":{"enabled":true},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"custom":{"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"}},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"emergencyCallSettings":{"enabled":true},"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}},"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"harassmentAssistance":true,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"auxiliaryTrackers":[],"startUnassignedDeparture":false,"driverParams":[],"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]}},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolbus":{"enabled":false}},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"parkingLots":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"driverCanCreateRoutes":true,"products":{"enabled":false}},"emailSuffixes":[],"admins":[],"timezone":"Chile/Continental","type":"normal","distance":0,"allowAds":false,"assocCommunities":[],"public":true,"name":"Comunidad Automatización 2","site":"http://adminstage.allrideapp.com","terms":null,"country":"cl","isStudentsCommunity":false,"hasBusesSystem":true,"language":"es","avatar":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083265.png","badge":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083787.png","createdAt":"2024-05-27T16:01:18.808Z","updatedAt":"2024-07-18T15:59:18.917Z","__v":29}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

Seat Reservation(1 hour-Nicolas) Must PASS
    Skip
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    POST On Session
    ...    mysesion
    ...    ${seatReservation}
    ...    data={"serviceId":"${service_id}","departureId":"${departureId}","stopId":"6654d4acba54fe502d4e6b6b","seat":"1"}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Run Keyword If    '${code}' == '200' or '${code}' == '409'    Log    Status code is acceptable: ${code}
    ...    ELSE    Fail    Unexpected status code: ${code}
    Log    ${code}

    ${reservation1}=    Set Variable    ${response.json()}[0][_id]
    Set Global Variable    ${reservation1}
Seat Reservation(1 hour-Nicolas) Must Fail
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json

    # Realiza la solicitud POST y espera un error HTTP 410
    ${error}=    Run Keyword And Expect Error    HTTPError: 410 Client Error: Gone for url: ${STAGE_URL}${seatReservation}    POST On Session
    ...    mysesion
    ...    ${seatReservation}
    ...    data={"serviceId":"${service_id2}","departureId":"${departureId2}","stopId":"6654d4acba54fe502d4e6b6b","seat":"1"}
    ...    headers=${headers}

    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    Log    ${error}

DELETE reservation1hour
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    DELETE On Session
    ...    mysesion
    ...    url=/api/v1/pb/user/booking/${reservation1}
    ...    data={}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Run Keyword If    '${code}' == '200' or '${code}' == '409'    Log    Status code is acceptable: ${code}
    ...    ELSE    Fail    Unexpected status code: ${code}
    Log    ${code}

Restriction 1 reservation 1 Day
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    PUT On Session
    ...    mysesion
    ...    url=https://stage.allrideapp.com/api/v1/admin/community/6654ae4eba54fe502d4e4187
    ...    data={"_id":"6654ae4eba54fe502d4e4187","config":{"general":{"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"public":true,"assocCommunities":[],"hidePersonalInfoForSC":false,"ui":{},"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"products":{"enabled":false}},"privateBus":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":1,"unit":"hours","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[]},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":false}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"emergencyCall":{"enabled":true},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"restrictRTL":{"enabled":false},"emergencyCallSettings":{"enabled":true},"enabled":true,"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"driverParams":[],"auxiliaryTrackers":[],"ui":{},"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]},"driverCanCreateRoutes":true,"hideSCDriverNames":false,"startUnassignedDeparture":false,"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}}},"parking":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolBus":{"enabled":false},"publicBus":{"enabled":true}},"custom":{"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"realTimeTransportSystem":{"buses":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":1,"unit":"days","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[],"maxValidationTime":{"amount":1,"unit":"hours"}},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"wfIntegration":{"enabled":false},"tracker":{"enabled":false},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"emergencyCall":{"enabled":true},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"custom":{"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"}},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"emergencyCallSettings":{"enabled":true},"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}},"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"harassmentAssistance":true,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"auxiliaryTrackers":[],"startUnassignedDeparture":false,"driverParams":[],"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]}},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolbus":{"enabled":false}},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"parkingLots":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"driverCanCreateRoutes":true,"products":{"enabled":false}},"emailSuffixes":[],"admins":[],"timezone":"Chile/Continental","type":"normal","distance":0,"allowAds":false,"assocCommunities":[],"public":true,"name":"Comunidad Automatización 2","site":"http://adminstage.allrideapp.com","terms":null,"country":"cl","isStudentsCommunity":false,"hasBusesSystem":true,"language":"es","avatar":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083265.png","badge":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083787.png","createdAt":"2024-05-27T16:01:18.808Z","updatedAt":"2024-07-18T16:02:03.393Z","__v":32}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

Seat Reservation (1 day - Nicolas) Must Fail
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json

    # Realiza la solicitud POST y espera un error HTTP 410
    ${error}=    Run Keyword And Expect Error    HTTPError: 410 Client Error: Gone for url: ${STAGE_URL}${seatReservation}    POST On Session
    ...    mysesion
    ...    ${seatReservation}
    ...    data={"serviceId":"${service_id2}","departureId":"${departureId}","stopId":"6654d4acba54fe502d4e6b6b","seat":"1"}
    ...    headers=${headers}

    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    Log    ${error}

DELETE reservation1day
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${accessTokenNico}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    DELETE On Session
    ...    mysesion
    ...    url=/api/v1/pb/user/booking/${reservation1}
    ...    data={}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Run Keyword If    '${code}' == '200' or '${code}' == '409'    Log    Status code is acceptable: ${code}
    ...    ELSE    Fail    Unexpected status code: ${code}
    Log    ${code}


Back to Normal Admin No Restriction
    
    Create Session    mysesion    ${STAGE_URL}    verify=true
    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary    Authorization=${tokenAdmin}    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    PUT On Session
    ...    mysesion
    ...    url=https://stage.allrideapp.com/api/v1/admin/community/6654ae4eba54fe502d4e4187
    ...    data={"_id":"6654ae4eba54fe502d4e4187","config":{"general":{"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"public":true,"assocCommunities":[],"hidePersonalInfoForSC":false,"ui":{},"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"products":{"enabled":false}},"privateBus":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":true,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[]},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":false}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"emergencyCall":{"enabled":true},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"restrictRTL":{"enabled":false},"emergencyCallSettings":{"enabled":true},"enabled":true,"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"driverParams":[],"auxiliaryTrackers":[],"ui":{},"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]},"driverCanCreateRoutes":true,"hideSCDriverNames":false,"startUnassignedDeparture":false,"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}}},"parking":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolBus":{"enabled":false},"publicBus":{"enabled":true}},"custom":{"privacySettings":{"general":{"hidePersonalInfoForSC":false},"privateBus":{"hideSCDriverNames":false,"hideSCRouteParams":false,"restrictAdmins":{"serviceCost":{"enabled":false,"allowed":"admins","adminIds":[],"adminLevels":[],"roleIds":[]}}}},"hasSubsidy":{"active":false,"subsidizedUsers":[],"userAmount":null,"subsidizedAmount":null},"realTimeTransportSystem":{"buses":{"oDDSettings":{"joinNewAdminODDs":true,"enableToNewUsers":{"enabled":true,"specificParams":{"enabled":false,"params":[]}}},"scheduling":{"enabled":true,"allowSeatReservations":true,"dynamicResourceAssignment":{"enabled":true,"limitTime":null,"limitUnit":""},"reservation":{"restrictions":{"enabled":false,"amount":1,"time":5,"unit":"minutes","userSkip":[]},"enabled":true},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"minimumTimeToAccept":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToStart":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToConfirm":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}},"minimumTimeToAssignDriver":{"enabled":false,"amount":1,"unit":"hours","sendTo":{"destinataries":"admins","emails":[],"adminLevels":[]}}},"budgetSystem":{"enabled":false},"restrictiveLabels":{"enabled":true,"labels":["etiqueta1"]},"validation":{"timestamp":{"userSkip":[],"enabled":false,"allowsSkip":false},"dailyLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":1},"timeLimit":{"userSkip":[],"enabled":false,"allowsSkip":false,"amount":null,"time":null,"unit":""},"departureLimit":{"userSkip":[],"enabled":true,"allowsSkip":false,"amount":1},"DNIValidation":{"enabled":true,"field":"Rut","allowsExternal":false},"bCValidation":{"enabled":true,"field":"Rut"},"customQRValidation":{"enabled":true,"field":"Rut"},"secureNFCValidation":{"enabled":false},"customValidation":{"enabled":false,"dataType":"text","options":[],"name":"","description":""},"customValidationParams":{"driverParams":[],"passengerParams":[],"maxValidationTime":{"amount":1,"unit":"hours"}},"usesInternalNFC":false,"validationToken":"","healthPoll":false,"enabled":true,"allowsStatic":false,"usesTickets":true,"ticketPrice":100,"usesPasses":false},"assistant":{"entryTimes":[],"departureTimes":[],"enabled":false,"collecting":false,"description":""},"poll":{"active":false,"answeredBy":[]},"wfIntegration":{"enabled":false},"tracker":{"enabled":false},"snapshots":{"service":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}},"nonService":{"enabled":true,"retentionTime":{"amount":0,"unit":"hours"}}},"harassmentAssistanceSettings":{"enabled":true,"showTextAbove":true,"aboveText":"","showInformation":true,"informationText":""},"emergencyCall":{"enabled":true},"healthPoll":{"enabled":false,"askUser":false},"passengerList":{"data":{"fullName":false,"validationParam":false,"phone":false,"community":false},"enabled":false},"custom":{"reports":{"visibleCode":"plate"},"driverApp":{"visibleCode":"plate"},"passengerApp":{"visibleCode":"plate"}},"multipleUseQRCodes":{"enabled":false,"uncapped":false,"amount":1},"internalRoutes":{"enabled":false},"internalLegs":{"enabled":false},"departureHourFulfillment":{"enabled":false,"ranges":[]},"arrivalHourFulfillment":{"enabled":false,"ranges":[]},"validateDeparture":{"enabled":true},"emergencyCallSettings":{"enabled":true},"dashboardAssignation":{"asap":{"minutesTillNextDeparture":360}},"apportionCategories":[],"labels":["etiqueta1"],"allowsRating":true,"allowsSnapshots":false,"allowsScreenshots":true,"usesPin":false,"harassmentAssistance":true,"noPassengerInfo":false,"allowGenericVehicles":true,"oDDServices":[{"pricing":{"timeDistanceConfig":{"tolls":[],"additionalCharges":[]},"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours","enabled":false},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":null,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[],"destinataries":"admins"},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"freeRequests":{"enabled":true,"asap":false},"limitedOptions":{"enabled":true},"joinDepartures":{"enabled":true,"maxCapacity":5,"distanceRatio":0},"reasons":{"list":[]},"defaultProvider":null},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false,"amount":null}},"restrictRequests":{"forService":{"settings":{"reservationSchedule":{"enabled":false,"minimum":"","maximum":""},"userCustomParams":{"enabled":false,"params":[]},"geographical":{"enabled":false,"zones":[]},"providers":[]},"enabled":false},"forProviders":{"enabled":false,"settings":[]}},"enabled":true,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":true,"allowsDistance":true,"exclusive":false,"_id":"668d4789d9f4e74159f19e38","name":"Taxis Nico","icon":"https://s3.amazonaws.com/allride.odd.icons/odd_taxi_icon.jpg","approvers":[],"entryTimes":[],"exitTimes":[],"notifications":[{"active":true,"_id":"668d4789d9f4e74159f19e39","action":"oDDepartureAccepted"},{"active":true,"_id":"668d4789d9f4e74159f19e3a","action":"oDDepartureStart"},{"active":true,"_id":"668d4789d9f4e74159f19e3b","action":"oDDepartureEnd"},{"active":true,"_id":"668d4789d9f4e74159f19e3c","action":"oDDepartureStopSkiped"},{"active":true,"_id":"668d4789d9f4e74159f19e3d","action":"oDDepartureAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e3e","action":"oDDepartureCanceled"},{"active":true,"_id":"668d4789d9f4e74159f19e3f","action":"oDDepartureDriverAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e40","action":"oDDepartureDriverReAssigned"},{"active":true,"_id":"668d4789d9f4e74159f19e41","action":"oDDepartureApproved"}],"legOptions":[]}],"fleetParams":[],"auxiliaryTrackers":[],"startUnassignedDeparture":false,"driverParams":[],"odd":{"pricing":{"model":"manual","useDistanceForApportioning":false,"zones":[],"costs":[]},"maximumReservationTime":{"amount":1,"unit":"hours"},"minimumReservationTime":{"amount":1,"unit":"hours"},"minimumApprovationAnticipationTime":{"amount":1,"unit":"hours"},"reservationExpirationTime":{"amount":1,"unit":"hours"},"minimumConfirmationTime":{"enabled":false,"amount":1,"unit":"hours"},"startLimit":{"enabled":false,"amount":1,"unit":"hours"},"joinTimeLimit":{"amount":20,"unit":"minutes"},"minimumTimeToAssignDriver":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToAccept":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToStart":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"minimumTimeToConfirm":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false,"amount":1,"unit":"hours"},"notifyNewODDRequest":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyNewODDCreated":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"notifyApprovedODD":{"sendTo":{"emails":[],"adminLevels":[],"roles":[]},"enabled":false},"canResume":{"timeLimit":{"enabled":false,"amount":5,"unit":"minutes"},"enabled":false},"pastServicesApproval":{"enabled":false},"validateDeparture":{"enabled":false},"userRequests":{"reasons":{"list":[]}},"providers":{"restrictCreation":{"enabled":false,"allowed":[]}},"skipApproval":{"byBudgetPercentage":{"enabled":false}},"enabled":false,"reasons":[],"hideEstimatedTimes":false,"allowsMultipleDrivers":false,"allowsDistance":false,"exclusive":false,"_id":"6654cc38713b9a5184cfdf7f","entryTimes":[],"exitTimes":[],"legOptions":[],"notifications":[],"approvers":[]}},"carpool":{"boardingConditions":{"enabled":false,"pickupLocationTolerance":200,"boardingTimeWindow":30,"driverPassengerProximity":100,"boardingQueryDelay":5},"emergencyCallSettings":{"enabled":true},"enabled":false,"communityOptions":false,"routePublishingOptions":[],"routeSearchRestrictions":[],"emergencyCall":{"enabled":true}},"cabpool":{"parameters":{"area":null,"originDistrict":null,"destinationDistrict":null,"folio":null,"line":null},"hasSOS":true},"schoolbus":{"enabled":false}},"validationParams":{"allowMultipleUseValidationCodes":false,"forceMandatoryParams":false,"params":[{"mandatory":true,"check":true,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e43","name":"Rut","description":"Rut","dataType":"rut","isUserStop":false,"validationExpr":""},{"mandatory":false,"check":false,"show":true,"private":false,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e44","name":"address","description":"Domicilio","dataType":"location","isUserStop":true,"validationExpr":""},{"mandatory":false,"check":false,"show":false,"private":true,"internal":false,"options":[],"_id":"668d4789d9f4e74159f19e45","name":"coordinates","description":"Coordenadas","dataType":"coordinates","isUserStop":true,"validationExpr":""}],"enabled":true},"parkingLots":{"enabled":false,"enableToAllUsers":false,"reservationByDay":false,"allowsScreenshots":false,"reservationModel":"priority","accessModel":"reservation","controlAccessAndExit":true,"usesCarpoolModel":false,"reservationLimit":{"time":1,"unit":"days"},"entryLimit":{"time":15,"unit":"minutes"},"exitLimit":{"time":15,"unit":"minutes"},"noExitLimit":{"time":1,"unit":"hours"},"necessaryTripsForAllDays":2,"necessaryTripsForMinDays":1,"minAvailableDays":3,"maxAvailableDays":5,"ranges":[],"terms":null,"specificLots":{"enabled":false,"lotIds":[]},"lotIdsAndKeysParams":[],"notifyInactiveUsers":{"enabled":false,"days":7},"chatWithoutReservation":false,"showPhoneNumber":false,"usesTickets":false,"usesPasses":false},"balance":{"enabled":true},"betaFeatures":[],"allowsManualUsers":true,"replacesManualUser":false,"allowAds":true,"allowCustomEmail":false,"allowCustomId":false,"hasUserMessagingSystem":true,"driverCanCreateRoutes":true,"products":{"enabled":false}},"emailSuffixes":[],"admins":[],"timezone":"Chile/Continental","type":"normal","distance":0,"allowAds":false,"assocCommunities":[],"public":true,"name":"Comunidad Automatización 2","site":"http://adminstage.allrideapp.com","terms":null,"country":"cl","isStudentsCommunity":false,"hasBusesSystem":true,"language":"es","avatar":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083265.png","badge":"https://s3.amazonaws.com/allride.uploads/communityAvatar_6654ae4eba54fe502d4e4187_1717603083787.png","createdAt":"2024-05-27T16:01:18.808Z","updatedAt":"2024-07-18T17:35:00.992Z","__v":41}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Should Be Equal As Numbers    ${code}    200
    Log    ${code}

Delete Route
    Create Session    mysesion    ${STAGE_URL}    verify=true

    # Define la URL del recurso que requiere autenticación (puedes ajustarla según tus necesidades)

    # Configura las opciones de la solicitud (headers, auth)
    ${headers}=    Create Dictionary
    ...    Authorization=${tokenAdmin}
    ...    Content-Type=application/json
    # Realiza la solicitud GET en la sesión por defecto
    ${response}=    DELETE On Session
    ...    mysesion
    ...    url=/api/v1/admin/pb/routes/${scheduleId}?community=${idComunidad2}
    ...    data={}
    ...    headers=${headers}
    # Verifica el código de estado esperado (puedes ajustarlo según tus expectativas)
    ${code}=    convert to string    ${response.status_code}
    Status Should Be    200
    Log    ${code}
    Sleep    5s
